---
title: Связанный контент
description: Список связанного контента в разделах «Смотрите также».
date: 2017-09-05
categories: [content management]
keywords: [content]
menu:
  docs:
    parent: "content-management"
    weight: 40
weight: 30
draft: false
aliases: [/content/related/,/related/]
toc: true
---


Hugo использует набор факторов для определения связанного содержания страницы на основе параметров Front Matter. Это может быть настроено на желаемый набор индексов и параметров или оставлено Хьюго по умолчанию [конфигурация связанного содержимого](#configure-related-content).

## Список связанного содержимого

Чтобы перечислить до 5 связанных страниц (которые имеют одинаковые параметры _date_ или _keyword_), достаточно просто включить что-то похожее на этот фрагмент в свой одностраничный шаблон:

{{< code file="layouts/partials/related.html" >}}
{{ $related := .Site.RegularPages.Related . | first 5 }}
{{ with $related }}
<h3>See Also</h3>
<ul>
	{{ range . }}
	<li><a href="{{ .RelPermalink }}">{{ .Title }}</a></li>
	{{ end }}
</ul>
{{ end }}
{{< /code >}}

### Методы

Вот список «связанных» методов, доступных в коллекции страниц, например `.RegularPages`.

#### СТРАНИЦА .Related

Возвращает коллекцию страниц, связанных с данной.

```
{{ $related := .Site.RegularPages.Related . }}
```

#### .RelatedIndices СТРАНИЦА INDICE1 [INDICE2 ...]

Возвращает коллекцию страниц, связанных с заданной страницей, ограниченной списком индексов.

```
{{ $related := .Site.RegularPages.RelatedIndices . "tags" "date" }}
```

#### .RelatedTo KEYVALS [KEYVALS2 ...]

Возвращает коллекцию страниц, связанных вместе набором индексов и их совпадением.

Чтобы построить этот набор и передать их в качестве аргумента, нужно использовать функцию `keyVals`, где первым аргументом будет `indice`, а последующие - его потенциальные совпадения `matches`.

```
{{ $related := .Site.RegularPages.RelatedTo ( keyVals "tags" "hugo" "rocks")  ( keyVals "date" .Date ) }}
```

{{% note %}}
Прочтите [эту статью в блоге](https://regisphilibert.com/blog/2018/04/hugo-optmized-relashionships-with-related-content/) для подробного объяснения более сложного использования этой функции.
{{% /note %}}

## Настроить связанный контент

Hugo предоставляет разумную конфигурацию связанного содержимого по умолчанию, но Вы можете настроить ее в своей конфигурации на глобальном или языковом уровне, если это необходимо.

### Конфигурация по умолчанию

Без какой-либо `related` конфигурации, установленной в проекте, методы связанного содержимого Hugo будут использовать следующее.

{{< code-toggle file="config" >}}
related:
  threshold: 80
  includeNewer: false
  toLower: false
  indices:
  - name: keywords
    weight: 100
  - name: date
    weight: 10
{{< /code-toggle >}}

Обратите внимание, что если Вы настроили теги `tags` в качестве таксономии, теги `tags` также будут добавлены в конфигурацию по умолчанию с весом `80`.

Пользовательская конфигурация должна быть установлена с использованием того же синтаксиса.

{{% note %}}
Если Вы добавляете раздел конфигурации `related`, Вам необходимо добавить полную конфигурацию. Невозможно просто установить, скажем, `includeNewer` и использовать остальное из значений по умолчанию для Hugo.
{{% /note %}}

### Параметры конфигурации верхнего уровня

threshold
: Значение от 0 до 100. Меньшее значение даст больше совпадений, но, возможно, не столь актуальных.

includeNewer
: Установите значение `true`, чтобы включить **страницы более новые, чем текущая страница**, в список связанного содержимого. Это будет означать, что вывод для старых сообщений может измениться по мере добавления нового связанного контента.

toLower
: Установите значение `true` для ключевых слов в нижнем регистре как в индексах, так и в запросах. Это может дать более точные результаты при небольшом снижении производительности. Обратите внимание, что это также можно установить для каждого индекса.

### Параметры конфигурации по индексу

name
: Имя индекса. Это значение отображается непосредственно на параметр страницы. Hugo поддерживает строковые значения (в примере `author`) и списки (`tags`, `keywords` и т.д.) и объекты времени и даты.

weight
: Целочисленный вес, который указывает _насколько важен_ этот параметр по сравнению с другими параметрами. Это может быть 0, что означает отключение этого индекса, или даже отрицательное значение. Попробуйте использовать разные значения, чтобы узнать, что лучше всего подходит для Вашего контента.

pattern
: В настоящее время это актуально только для дат. При перечислении связанного контента мы можем захотеть перечислить контент, который также близок по времени. Установка «2006» (значение по умолчанию для индексов даты) в качестве шаблона для индекса даты добавит веса страницам, опубликованным в том же году. Для более загруженных блогов лучшим вариантом по умолчанию может быть «200601» (год и месяц).

toLower
: Смотрите выше.

## Соображения производительности

**Быстрота - это второе имя Хьюго**, и мы бы не выпустили эту функцию, если бы она не была быстрой.

Эта функция была в резервном журнале и многие давно просили ее. Эта недавняя разработка началась с этой ветки в Twitter:

{{< tweet 898398437527363585 >}}

Скотт С. Лоу удалил раздел «Связанное содержимое», созданный с помощью функции шаблона `intersect` для тегов, и время сборки упало с 30 до менее 2 секунд в его блоге размером 1700 страниц с контентом.

Теперь он должен иметь возможность добавить улучшенную версию раздела «Связанное содержимое», не отказываясь от быстрой перезагрузки в реальном времени. Но стоит отметить, что:

* Если Вы не используете какой-либо из `Related` методов, Вы не будете использовать функцию «Связать контент», и производительность будет такой же, как и раньше.
* Вызов `.RegularPages.Related` и т.д. создаст один инвертированный индекс, также иногда называемый списком публикаций, который будет повторно использоваться для любых поисков в той же самой коллекции страниц. Выполнение этого в дополнение к, например, вызову `.Pages.Related` будет работать, как ожидалось, но создаст один дополнительный инвертированный индекс. Это все равно должно быть очень быстро, но о нем стоит помнить, особенно для крупных сайтов.

{{% note %}}
В настоящее время мы не индексируем **содержимое страницы**. Мы думали, что выпустим что-то, что порадует большинство людей, прежде чем мы начнем решать [последнее дело Шерлока](https://github.com/joearms/sherlock).
{{% /note %}}
